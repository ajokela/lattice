// Test: expression evaluation round-trip through self-hosted compiler
// Covers arithmetic, float ops, string ops, boolean logic, bitwise, comparisons

fn test_integer_arithmetic() {
    print("--- integer arithmetic ---")
    print(2 + 3)
    print(100 - 37)
    print(7 * 8)
    print(100 / 4)
    print(17 % 5)
    print(-42)
    print(1 + 2 * 3)
    print((1 + 2) * 3)
    print(10 / 2 + 3 * 4)
    print((10 + 2) * (3 + 4))
}

fn test_float_arithmetic() {
    print("--- float arithmetic ---")
    print(3.14 + 2.86)
    print(1.5 * 2.0)
    print(10.0 / 4.0)
    print(7.5 - 2.5)
    print(10.0 - 7.5)
}

fn test_comparisons() {
    print("--- comparisons ---")
    print(3 < 5)
    print(5 < 3)
    print(3 > 5)
    print(5 > 3)
    print(3 <= 3)
    print(4 <= 3)
    print(3 >= 3)
    print(3 >= 4)
    print(3 == 3)
    print(3 == 4)
    print(3 != 4)
    print(3 != 3)
}

fn test_boolean_logic() {
    print("--- boolean logic ---")
    print(true && true)
    print(true && false)
    print(false && true)
    print(false && false)
    print(true || true)
    print(true || false)
    print(false || true)
    print(false || false)
    print(!true)
    print(!false)
}

fn test_bitwise() {
    print("--- bitwise ---")
    print(6 & 3)
    print(6 | 3)
    print(6 ^ 3)
    print(~0)
    print(1 << 3)
    print(16 >> 2)
    print(255 & 0)
    print(0 | 15)
}

fn test_string_operations() {
    print("--- string operations ---")
    print("hello" + " " + "world")
    print("abc" == "abc")
    print("abc" != "def")
    print("abc" == "def")
    print(len("hello"))
    print(len(""))

    let name = "lattice"
    let ver = 42
    print("lang: ${name}")
    print("version ${ver}")
    print("${name} v${ver}")
}

fn test_nil_and_unit() {
    print("--- nil and unit ---")
    print(nil)
    print(nil == nil)
    print(nil != nil)
    print(nil == 0)
    print(nil == false)
}

fn test_nil_coalesce() {
    print("--- nil coalesce ---")
    let a = nil ?? "default"
    print(a)
    let b = "value" ?? "default"
    print(b)
    let c = nil ?? nil ?? "last"
    print(c)
}

fn main() {
    test_integer_arithmetic()
    test_float_arithmetic()
    test_comparisons()
    test_boolean_logic()
    test_bitwise()
    test_string_operations()
    test_nil_and_unit()
    test_nil_coalesce()
    print("ALL EXPRESSION TESTS PASSED")
}
